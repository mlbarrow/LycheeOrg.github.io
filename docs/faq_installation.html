<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Lychee Documentation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

    <link rel="canonical" href="https://lycheeorg.github.io/docs/">

    <!-- Favicon -->
    <!-- <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png"> -->
    <link rel="icon" type="image/png" href="/assets/images/logo.png">
    <!-- <link rel="icon" type="image/png" sizes="32x32" href="/img/favicon/favicon-32x32.png"> -->
    <!-- <link rel="icon" type="image/png" sizes="16x16" href="/img/favicon/favicon-16x16.png"> -->
    <!-- <link rel="manifest" href="/img/favicon/site.webmanifest"> -->
    <!-- <link rel="mask-icon" href="/img/favicon/safari-pinned-tab.svg" color="#ff2d20"> -->
    <!-- <link rel="shortcut icon" href="/img/favicon/favicon.ico"> -->
    <meta name="msapplication-TileColor" content="#ff2d20">
    <!-- <meta name="msapplication-config" content="/img/favicon/browserconfig.xml"> -->
    <meta name="theme-color" content="#ffffff">

    <!-- Load styles -->
    <link rel="stylesheet" type="text/css" href="css/app.css">
    <link rel="stylesheet" type="text/css" href="css/prism.css">

    <!-- Load JS -->
    <script src="js/vendor/jquery.js"></script>
    <script src="js/vendor/prism.js"></script>

</head>

<body>

    <div class="sidebar_layout" id="docsScreen">

        <div class="page_contain">
            <div class="contain">
                <aside class="sidebar">
                    <a href="../" class="logo">
                        <img class="mark" src="/assets/images/logo.png" alt="Laravel">
                        <img class="type" src="img/Lychee.png" alt="Laravel">
                    </a>
                    <nav>
                        <div class="navigation_contain">
                            <div class="docs_sidebar">
                                <ul>
                                    <li class='sub--on'>
<h2>Prologue</h2>
<ul>
<li><a href='org.html'>Lychee & LycheeOrg</a></li>
<li><a href='releases.html'>Release Notes</a></li>
</ul>
<li class='sub--on'>
<h2>Getting Started</h2>
<ul>
<li><a href='installation.html'>Installation</a></li>
<li><a href='configuration.html'>Configuration</a></li>
<li><a href='docker.html'>Docker</a></li>
<li><a href='update.html'>Update</a></li>
<li><a href='upgrade.html'>Upgrade from v3</a></li>
</ul>
<li class='sub--on'>
<h2>Advanced Topics</h2>
<ul>
<li><a href='settings.html'>Settings</a></li>
<li><a href='keyboard.html'>Keyboard Shortcuts</a></li>
<li><a href='advanced-setups.html'>Advanced Setups</a></li>
<li><a href='external_tracking.html'>External tracking with Matomo, Google Analytics & Co</a></li>
</ul>
<li class='sub--on'>
<h2>Frequently Asked Question</h2>
<ul>
<li><a href='faq_general.html'>General</a></li>
<li class='active'><a href='faq_installation.html'>Installation, migration, upgrade, update</a></li>
<li><a href='faq_troubleshooting.html'>Troubleshooting</a></li>
</ul>
<li class='sub--on'>
<h2>Contributing</h2>
<ul>
<li><a href='contributions.html'>Contribution Guide</a></li>
<li><a href='api.html'>API Documentation</a></li>
<li><a href='architecture.html'>Lychee logic overview</a></li>
<li><a href='structure.html'>Directory Structure</a></li>
<li><a href='frontend.html'>Front-end</a></li>
<li><a href='livewire.html'>Livewire Front-end (alpha)</a></li>
</ul>

                                    <li class="laravel">
                                        <a href="https://laravel.com/docs/8.x"><h2>Laravel<img style="margin-left:4px;" src="img/external-link.svg" /></h2></a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </nav>
                    <div class="trigger_contain">
                        <a href="#" class="nav_trigger" aria-label="Menu">
                            <div class="bar"></div>
                        </a>
                    </div>
                </aside>

                <section class="body_content">
                    <section class="docs_body">
                        <section class="docs_main">
                            <h1>Installation, migration, upgrade, update</h1>
                            
<ul>
<li><a href="#how-can-i-install-lychee-without-ssh-access">How can I install Lychee without SSH access?</a></li>
<li><a href="#how-do-i-upgrade-from-lychee-v3-to-lychee-v4">How do I upgrade from Lychee v3 to Lychee v4?</a></li>
<li><a href="#how-can-i-back-up-my-installation">How can I back up my installation?</a></li>
<li><a href="#how-can-i-migrate-my-installation-to-a-new-host">How can I migrate my installation to a new host?</a></li>
<li><a href="#can-i-host-lychee-with-a-subpath-with-nginx-like-httpsexampledevlychee">Can I host Lychee with a subpath with Nginx? Like https://example.dev/lychee/</a></li>
<li><a href="#can-i-host-lychee-with-a-subpath-with-apache-like-httpsexampledevlychee">Can I host Lychee with a subpath with Apache? Like https://example.dev/lychee/</a></li>
<li><a href="#do-we-really-need-writable-app">Do we really need writable app/?</a></li>
<li><a href="#is-it-possible-to-do-the-update-directly-from-the-gui-how">Is it possible to do the update directly from the GUI? How?</a></li>
<li><a href="#can-i-migrate-from-a-64-bit-system-to-a-32-bit-system">Can I migrate from a 64-bit system to a 32-bit system?</a></li>
<li><a href="#why-cant-i-see-the-check-for-update-button-in-the-gui">Why can't I see the check for update button in the GUI?</a></li>
<li><a href="#how-can-i-stop-artisan-migrate-and-composer-from-running-after-every-git-pull">How can I stop artisan migrate and composer from running after every git pull?</a></li>
</ul>

                            <hr> <h3 id="how-can-i-install-lychee-without-ssh-access"><a class="toclink" href="#how-can-i-install-lychee-without-ssh-access">How can I install Lychee without SSH access?</a></h3>
<ol>
<li>Download the latest release</li>
<li>Extract and upload the folder via FTP</li>
<li>access the website</li>
</ol>
<p>If you are at the wrong address you will be told to go to the <code>public</code> folder.
Once open, you will be redirected to the install procedure. Completed you will be able to create an admin account and enjoy Lychee.</p>
<h3 id="how-do-i-upgrade-from-lychee-v3-to-lychee-v4"><a class="toclink" href="#how-do-i-upgrade-from-lychee-v3-to-lychee-v4">How do I upgrade from Lychee v3 to Lychee v4?</a></h3>
<p>The process is described <a href="upgrade.html">here</a>.</p>
<h3 id="how-can-i-back-up-my-installation"><a class="toclink" href="#how-can-i-back-up-my-installation">How can I back up my installation?</a></h3>
<p>To back up your Lychee installation you need to perform the following steps:</p>
<ol>
<li>Create a copy of at least the following parts of the Lychee directory tree (e.g., <code>/var/www/html/Lychee</code>):</li>
</ol>
<pre><code>.env
public/dist/user.css
public/uploads/
</code></pre>
<ol>
<li>Dump the Lychee database to a file. E.g., if you are using MySQL, run:</li>
</ol>
<pre><code class="language-bash">mysqldump -u user -ppassword --databases lychee_database &gt; lychee_backup.sql
</code></pre>
<p>Replace <code>user</code>, <code>password</code>, and <code>lychee_database</code> by the values of <code>DB_USERNAME</code>, <code>DB_PASSWORD</code>, and <code>DB_DATABASE</code> from the <code>.env</code> file in the Lychee folder.</p>
<h3 id="how-can-i-migrate-my-installation-to-a-new-host"><a class="toclink" href="#how-can-i-migrate-my-installation-to-a-new-host">How can I migrate my installation to a new host?</a></h3>
<ol>
<li>Back up your installation as described above</li>
<li>Download the latest release of Lychee.</li>
<li>Overwrite the files with your back up</li>
<li>Restore the database on the new host, e.g., for MySQL: <code>mysql -u user -ppassword &lt; lychee_backup.sql</code></li>
</ol>
<h3 id="can-i-host-lychee-with-a-subpath-with-nginx-like-httpsexampledevlychee"><a class="toclink" href="#can-i-host-lychee-with-a-subpath-with-nginx-like-httpsexampledevlychee">Can I host Lychee with a subpath with Nginx? Like <code>https://example.dev/lychee/</code></a></h3>
<p>Yes, here is a configuration to help you:</p>
<pre><code class="language-nginx">location ^~ /lychee {
    alias /var/www/lychee/public;
    index index.php;
    try_files $uri $uri/ @lychee;
    location ~ \.php$ {
        if (!-e $request_filename) {
            rewrite ^/lychee/?(.*)$ /lychee/index.php?/$1 last;
            break;
        }
        fastcgi_pass unix:/var/run/php/php7.4-fpm.sock;
        fastcgi_index index.php;
        include fastcgi_params;
        fastcgi_param SCRIPT_FILENAME $request_filename;
    }
}
location @lychee {
    rewrite /lychee/(.*)$ /lychee/index.php?/$1 last;
}
</code></pre>
<h3 id="can-i-host-lychee-with-a-subpath-with-apache-like-httpsexampledevlychee"><a class="toclink" href="#can-i-host-lychee-with-a-subpath-with-apache-like-httpsexampledevlychee">Can I host Lychee with a subpath with Apache? Like <code>https://example.dev/lychee/</code></a></h3>
<p>Yes, just create a Symbolic Link and allow your apache configuration to follow them.
At website.com root <code>ln -s Lychee/public pics</code> and you will get exactly what you want: <code>website.com/pics</code></p>
<h3 id="do-we-really-need-writable-app"><a class="toclink" href="#do-we-really-need-writable-app">Do we really need writable <code>app/</code>?</a></h3>
<p>From <a href="https://github.com/LycheeOrg/Lychee/issues/311">#311</a></p>
<p>Short answer: Lychee will work without a writable <code>app/</code> folder.</p>
<p>However, if you want to be able to update your Lychee installation with a click of a button in the web browser (though it's disabled by default), your whole Lychee installation tree (and not just <code>app/</code>) must be http-writable.</p>
<p>As far as I know, the minimum set of directories that need to be http-writable is as follows:</p>
<pre><code>storage/
storage/
storage/
public/uploads/small
public/uploads/big
public/uploads/thumb
public/uploads/medium
public/uploads/import
public/dist
</code></pre>
<h3 id="is-it-possible-to-do-the-update-directly-from-the-gui-how"><a class="toclink" href="#is-it-possible-to-do-the-update-directly-from-the-gui-how">Is it possible to do the update directly from the GUI? How?</a></h3>
<p>You go to <code>Diagnostics</code> &Rarr; <code>Check for Updates</code><br />
Once done you need to update the <code>Diagnostic</code> page (click on it again in the left menu) 
You will see a <code>Apply Update</code> button on the top. Click on it and done.
If it breaks (error 500) you can still go back to command line and do your <code>git pull</code>, migrate etc...</p>
<p>There are some securities that you need to disable via the advanced settings menu:</p>
<ul>
<li>you need to allow update if your <code>.env</code> specify <code>production</code>:<br />
<code>force_migration_in_production = 1</code></li>
<li>you need to allow composer :<br />
<code>apply_composer_update = 1</code> (optional)</li>
</ul>
<p>The second one is really optional if updates don't need the composer (like 90% of the time) then it can just stay at <code>0</code>.</p>
<h3 id="can-i-migrate-from-a-64-bit-system-to-a-32-bit-system"><a class="toclink" href="#can-i-migrate-from-a-64-bit-system-to-a-32-bit-system">Can I migrate from a 64-bit system to a 32-bit system?</a></h3>
<p>Yes, but it's not trivial or recommended. After copying the database:
1. Download <a href="https://github.com/LycheeOrg/Lychee/raw/54d00878949906c2efd4f6ddd9e79669637c58fb/database/migrations/2019_04_07_193345_fix_32bit.php">this</a> file to your <code>database/migrations/</code> folder.
2. Run  the SQL command <code>delete from migrations where migration='2019_04_07_193345_fix_32bit';</code> to make sure it will run.
3. Run <code>php artisan migrate</code>. This should run a one-off migration that was originally added to allow 32-bit systems to migrate from Lychee v3.</p>
<p>This will only work on top-level albums. Subalbums will require <a href="https://github.com/LycheeOrg/Lychee/issues/406#issuecomment-571378073">manual intervention</a>.</p>
<h3 id="why-cant-i-see-the-check-for-update-button-in-the-gui"><a class="toclink" href="#why-cant-i-see-the-check-for-update-button-in-the-gui">Why can't I see the <em>check for update</em> button in the GUI?</a></h3>
<ul>
<li>Make sure you are using a <code>git</code> installation and not a downloaded release</li>
<li>Make sure you are on the <code>master</code> branch</li>
<li>Make sure your web user has read and write access to <code>.git</code></li>
<li>Check that <code>exec</code> is available.</li>
<li>Check that <code>allow_online_git_pull</code> setting is set to <code>1</code></li>
</ul>
<h3 id="how-can-i-stop-artisan-migrate-and-composer-from-running-after-every-git-pull"><a class="toclink" href="#how-can-i-stop-artisan-migrate-and-composer-from-running-after-every-git-pull">How can I stop <code>artisan migrate</code> and <code>composer</code> from running after every <code>git pull</code>?</a></h3>
<p>We've set composer to install git <code>pre-commit</code> and <code>post-merge</code> hooks by default.
- The pre-commit is to help developers by checking and fixing and code style problems before they hit our testing. If you aren't committing and changes, this will not be run.
- The post-merge ensures that your dependencies and database version are kept current. This can be disabled by creating a file <code>.NO_AUTO_COMPOSER_MIGRATE</code> in your Lychee root and deleting (if necessary) <code>.git/hooks/post-merge</code>. If you disable this script, you will need to run <code>composer</code> and <code>artisan migrate</code> manually. Alternatively, the Update UI can be set to handle this if you run your updates there.</p><blockquote><p>{tip} Caught a mistake or want to contribute to the documentation?&nbsp;<a href="https://github.com/LycheeOrg/LycheeOrg.github.io/tree/master/docs/faq_installation.md">Edit this page on Github!</a></p></blockquote>
                        </section>
                    </section>
                </section>
            </div>
        </div>

    </div>
</body>
<script src="js/app.js"></script>

</html>
